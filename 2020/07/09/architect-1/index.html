<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Nginx,">










<meta name="description" content="å¥½çš„ï¼Œæˆ‘ä»¬æ¥æwebæœåŠ¡å™¨ï¼Œè¿™ä¸€èŠ‚ä¸»è¦åŒ…æ‹¬ä¸€ä¸‹å†…å®¹ï¼šNginxï¼ˆTengineï¼‰å®‰è£…&amp;amp;è„šæœ¬åŒ–æ“ä½œã€Nginxä½¿ç”¨ç®€ä»‹ã€Nginxé…ç½®æ–‡ä»¶åˆ†æ">
<meta name="keywords" content="Nginx">
<meta property="og:type" content="article">
<meta property="og:title" content="JavaWebç¬”è®°-Nginx D1">
<meta property="og:url" content="http://yoursite.com/2020/07/09/architect-1/index.html">
<meta property="og:site_name" content="é»‘é¢å®å®çš„åšå®¢">
<meta property="og:description" content="å¥½çš„ï¼Œæˆ‘ä»¬æ¥æwebæœåŠ¡å™¨ï¼Œè¿™ä¸€èŠ‚ä¸»è¦åŒ…æ‹¬ä¸€ä¸‹å†…å®¹ï¼šNginxï¼ˆTengineï¼‰å®‰è£…&amp;amp;è„šæœ¬åŒ–æ“ä½œã€Nginxä½¿ç”¨ç®€ä»‹ã€Nginxé…ç½®æ–‡ä»¶åˆ†æ">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2020-07-13T04:18:29.796Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="JavaWebç¬”è®°-Nginx D1">
<meta name="twitter:description" content="å¥½çš„ï¼Œæˆ‘ä»¬æ¥æwebæœåŠ¡å™¨ï¼Œè¿™ä¸€èŠ‚ä¸»è¦åŒ…æ‹¬ä¸€ä¸‹å†…å®¹ï¼šNginxï¼ˆTengineï¼‰å®‰è£…&amp;amp;è„šæœ¬åŒ–æ“ä½œã€Nginxä½¿ç”¨ç®€ä»‹ã€Nginxé…ç½®æ–‡ä»¶åˆ†æ">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":true,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'åšä¸»'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2020/07/09/architect-1/">





  <title>JavaWebç¬”è®°-Nginx D1 | é»‘é¢å®å®çš„åšå®¢</title>
  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?bb1b3f4c4b4bc6dbe5d0c19279b2faa2";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">é»‘é¢å®å®çš„åšå®¢</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">ç²¾é€šLinuxã€OpenStackã€Dockerç­‰å•è¯æ‹¼å†™</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            é¦–é¡µ
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            æ ‡ç­¾
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categrories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            åˆ†ç±»
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            å½’æ¡£
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            ä½œè€…
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/07/09/architect-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="é»‘é¢å®å®">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/uploads/img.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="é»‘é¢å®å®çš„åšå®¢">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">JavaWebç¬”è®°-Nginx D1</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2020-07-09T17:10:45+08:00">
                2020-07-09
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Javaå¼€å‘/" itemprop="url" rel="index">
                    <span itemprop="name">Javaå¼€å‘</span>
                  </a>
                </span>

                
                
              

              <span class="post-time">
                &nbsp; | &nbsp;
                <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
                </span>
                <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿</span>
                <span class="post-count"> 20min </span>
                </span>
              </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2020/07/09/architect-1/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2020/07/09/architect-1/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/2020/07/09/architect-1/" class="leancloud_visitors" data-flag-title="JavaWebç¬”è®°-Nginx D1">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>å¥½çš„ï¼Œæˆ‘ä»¬æ¥æwebæœåŠ¡å™¨ï¼Œè¿™ä¸€èŠ‚ä¸»è¦åŒ…æ‹¬ä¸€ä¸‹å†…å®¹ï¼šNginxï¼ˆTengineï¼‰å®‰è£…&amp;è„šæœ¬åŒ–æ“ä½œã€Nginxä½¿ç”¨ç®€ä»‹ã€Nginxé…ç½®æ–‡ä»¶åˆ†æ</p>
<a id="more"></a>
<p>å‰ä¸‰å¤©çš„åšå®¢æ•´ç†çš„æœ‰äº›æ°´ï¼Œä¸»è¦å› ä¸ºä¸œè¥¿æ˜¯å¾ˆä¹…ä»¥å‰å­¦çš„ï¼Œè€Œä¸”å‘ç°è‡ªå·±åœ¨CSDNä¸Šæœ‰æ•´ç†ç¬”è®°ï¼Œå°±ç›´æ¥CVå¤§æ³•ç…§æ¬äº†ï¼Œä½†æ˜¯ä»¥å‰è®°çš„ä¸œè¥¿çœŸçš„çƒ‚ï¼Œè¿‡ä¸€æ®µæ—¶é—´æ‹¿å‡ºæ¥å°±æ„Ÿè§‰å·²ç»è¯»ä¸æ‡‚å½“åˆåœ¨å†™äº›ä»€ä¹ˆäº†ğŸ˜‚</p>
<p>å¥½äº†å¼€å§‹æ•´ç†ä»Šå¤©çš„ç¬”è®°ï¼Œè¿™é‡Œçš„åšå®¢åæ¥æˆ‘è°ƒæ•´è¿‡å°èŠ‚çš„é¡ºåºå¹¶åšè¿‡å†…å®¹ä¿®æ”¹ï¼Œå› ä¸ºæˆ‘è§‰å¾—ç°åœ¨çš„é¡ºåºæ›´åŠ ä¾¿äºç†è§£</p>
<h2 id="Nginxï¼ˆTengineï¼‰å®‰è£…-amp-è„šæœ¬åŒ–æ“ä½œ"><a href="#Nginxï¼ˆTengineï¼‰å®‰è£…-amp-è„šæœ¬åŒ–æ“ä½œ" class="headerlink" title="Nginxï¼ˆTengineï¼‰å®‰è£…&amp;è„šæœ¬åŒ–æ“ä½œ"></a>Nginxï¼ˆTengineï¼‰å®‰è£…&amp;è„šæœ¬åŒ–æ“ä½œ</h2><p>Nginxæ˜¯ä¸€æ¬¾è½»é‡çº§çš„WebæœåŠ¡å™¨ã€åå‘ä»£ç†æœåŠ¡å™¨ã€ç”µå­é‚®ä»¶ä»£ç†æœåŠ¡å™¨ï¼Œç”±ä¿„ç½—æ–¯çš„ç¨‹åºè®¾è®¡å¸ˆIgor Sysoevæ‰€å¼€å‘ï¼›å»å¹´å¹´åº•æœ‰å…³äºNginxä¹‹çˆ¶Sysoevè¢«æ•çš„æ–°é—»ï¼Œå¤§è‡´å†…å®¹æ˜¯Sysoevçš„è€ä¸œå®¶Ramblerå…¬å¸è®¤ä¸ºNginxæ˜¯Sysoevåœ¨å…¬å¸ä»»èŒæœŸé—´å¼€å‘çš„ï¼Œæ‰€æœ‰æƒä¹Ÿåº”è¯¥æ˜¯å…¬å¸çš„ï¼Œé‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œç¨‹åºçŒ¿åœ¨ä¸šä½™æ—¶é—´å¼€å‘çš„ä¸œè¥¿ä¹Ÿå±äºå…¬å¸å—â€¦ </p>
<p>è¿™é‡Œæ˜¯ä½¿ç”¨çš„æ˜¯Tengineï¼ŒTengineæ˜¯ç”±æ·˜å®å‘èµ·çš„WebæœåŠ¡å™¨é¡¹ç›®ï¼Œå®ƒåœ¨Nginxçš„åŸºç¡€ä¸Šï¼Œé’ˆå¯¹å¤§è®¿é—®é‡ç½‘ç«™çš„éœ€æ±‚ï¼Œæ·»åŠ äº†å¾ˆå¤šé«˜çº§åŠŸèƒ½å’Œç‰¹æ€§ï¼Œå®Œå…¨å…¼å®¹Nginxçš„é…ç½®ï¼Œç»§æ‰¿äº†Nginxçš„ç‰¹æ€§ï¼›æ‰€è¿™é‡Œç®—æ˜¯åˆ©ç”¨Tengineå­¦ä¹ Nginxï¼ŒTengineæä¾›çš„è®¸å¤šåŠŸèƒ½éå¸¸ä¾¿äºå¼€å‘ä¸è°ƒè¯•ï¼Œåç»­ä¸ºäº†æ–¹ä¾¿ç†è§£é™¤äº†ä½¿ç”¨Tengineçš„ç‰¹æ€§ä»¥å¤–çš„åœ°æ–¹æˆ‘éƒ½ä¼šæŠŠTengineç§°ä¸ºNginxã€‚å…¶å®æœ‰ç‚¹æ€ªå“ˆï¼Œå°±åƒæ˜¯ä½ æŠŠTypeScriptå«åšJavaScriptä¸€æ ·ğŸ˜‚</p>
<h3 id="ç¯å¢ƒ-amp-ä¾èµ–"><a href="#ç¯å¢ƒ-amp-ä¾èµ–" class="headerlink" title="ç¯å¢ƒ&amp;ä¾èµ–"></a>ç¯å¢ƒ&amp;ä¾èµ–</h3><p>æ“ä½œç³»ç»Ÿï¼š centOS</p>
<p>ä¾èµ–ç»„ä»¶ï¼š gcc openssl-devel pcre-devel zlib-devel</p>
<p>è¿™é‡Œè¦æ£€æŸ¥ä¸€ä¸‹ä½ çš„æœåŠ¡å™¨æˆ–è€…è™šæ‹Ÿæœºæœ‰æ²¡æœ‰ä¸Šè¿°çš„ç»„ä»¶ï¼Œç›´æ¥åœ¨Terminalé‡Œæ•²ä¸€æ•²ä»–ä»¬çš„åå­—å°±çŸ¥é“äº†ï¼Œå¦‚æœä¾èµ–ä¸å…¨çš„æƒ…å†µä¸‹å°è¯•å®‰è£…ï¼Œåœ¨æ‰§è¡Œconfigureæ—¶ä¼šæŠ¥é”™</p>
<p>å¦‚æœä½ çš„æœåŠ¡å™¨æ˜¯RedHatçš„Linuxï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å®‰è£…ä¾èµ–<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install gcc openssl-devel pcre-devel zlib-devel</span><br></pre></td></tr></table></figure></p>
<h3 id="ä¸‹è½½-amp-å®‰è£…"><a href="#ä¸‹è½½-amp-å®‰è£…" class="headerlink" title="ä¸‹è½½&amp;å®‰è£…"></a>ä¸‹è½½&amp;å®‰è£…</h3><p><strong>ä¸‹è½½&amp;è§£å‹Tengine</strong></p>
<p><a href="http://tengine.taobao.org/" target="_blank" rel="noopener">http://tengine.taobao.org/</a></p>
<p>éšæ„æ‰¾ä¸€ä¸ªæœåŠ¡å™¨ç›®å½•è§£å‹Tengineæºä»£ç ï¼Œè§£å‹åè¿›å…¥æºä»£ç æ ¹ç›®å½•</p>
<p><strong>ç¼–è¯‘å®‰è£…</strong><br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">./ configure --prefix=/usr/local/tengine</span><br><span class="line"></span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure></p>
<p>é€šå¸¸å°†tengineå®‰è£…åœ¨<code>/usr/local/tengine</code>ç›®å½•ä¸‹</p>
<p>å®Œæˆä»¥ä¸Šä¸¤æ­¥Nginxå°±å·²ç»å®‰è£…å®Œæˆï¼Œå¯ä»¥è¿›å…¥åˆ°<code>/usr/local/tengine</code>ç›®å½•ä¸­æŸ¥çœ‹ç¼–è¯‘åçš„æ–‡ä»¶ï¼Œè¿™ä¸ªç›®å½•æœ‰confã€htmlã€logsä»¥åŠsbinå››ä¸ªæ–‡ä»¶å¤¹ï¼Œå…¶ä¸­sbiné‡Œä¿å­˜æ‰€æœ‰å¯æ‰§è¡Œæ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥è¿è¡Œå…¶ä¸­çš„nginxè¿™æ ·nginxæœåŠ¡å™¨å°±å¯åŠ¨äº†ï¼Œæ‰“å¼€æµè§ˆå™¨è®¿é—®æœåŠ¡å™¨çš„å…¬ç½‘ipå°±èƒ½çœ‹åˆ°Nginxé»˜è®¤çš„ä¸»é¡µã€‚</p>
<p>ç›´æ¥å¯åŠ¨nginxçš„è¯å…³é—­æœåŠ¡å™¨æ¯”è¾ƒéº»çƒ¦ï¼Œéœ€è¦ç”¨ä¼ ç»Ÿçš„kill -9 æ€æ‰å¯¹åº”çš„æ‰€æœ‰è¿›ç¨‹<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ps -ef | grep nginx</span><br><span class="line">kill -9 [pid]</span><br></pre></td></tr></table></figure></p>
<h3 id="è¡¥å……"><a href="#è¡¥å……" class="headerlink" title="è¡¥å……"></a>è¡¥å……</h3><p>åæ¥åˆåœ¨macç³»ç»Ÿä¸‹å®‰è£…Nginxé‡åˆ°äº†äº›å°å°çš„é—®é¢˜ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œä¹Ÿè®°å½•ä¸€ä¸‹å®‰è£…è¿‡ç¨‹ï¼Œmacç³»ç»Ÿä¹Ÿæ˜¯å†…ç½®äº†opensslï¼Œä½†æ˜¯åœ¨ç”Ÿæˆmakefileæ­¥éª¤ä¸­è¿˜æ˜¯é‡åˆ°äº†æ‰¾ä¸åˆ°opensslä¾èµ–çš„é—®é¢˜ï¼Œä¼¼ä¹æ˜¯å› ä¸ºmacOSå†…ç½®çš„ç‰ˆæœ¬è¿‡ä½ï¼Ÿ</p>
<p>åœ¨macç³»ç»Ÿä¸­ï¼Œå¯ä»¥ä½¿ç”¨<code>brew install nginx</code>å®‰è£…ï¼Œè¿™æ ·çš„é—®é¢˜æ˜¯å¯¹äºè½¯ä»¶çš„ç‰ˆæœ¬ä¸å¤ªå¯æ§ï¼Œæ‰€ä»¥è¿™é‡Œé‡‡ç”¨æ‰‹åŠ¨ç¼–è¯‘æºç çš„çš„æ–¹å¼</p>
<p>é¦–å…ˆéœ€è¦çš„ä¸‹è½½æºä»£ç ï¼Œåˆ°åŒä¸€ä¸ªç›®å½•ä¸­<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://nginx.org/download/nginx-1.17.8.tar.gz</span><br><span class="line">https://ftp.pcre.org/pub/pcre/pcre-8.41.tar.gz</span><br><span class="line">https://www.openssl.org/source/openssl-1.1.0g.tar.gz</span><br></pre></td></tr></table></figure></p>
<p>è¿›å…¥nginxæºç ç›®å½•ï¼Œè¿è¡Œconfigureï¼Œå¹¶è®¾ç½®ä¾èµ–çš„è·¯å¾„ï¼Œè¿™é‡Œè®¾ç½®å®‰è£…ç›®å½•ä¾æ—§æ˜¯åœ¨/usr/local/nginx<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">./configure --with-pcre=../pcre-8.41/ --with-http_ssl_module --with-openssl=../openssl-1.1.0g --prefix=/usr/local/nginx</span><br><span class="line"></span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure></p>
<h3 id="è„šæœ¬åŒ–æ“ä½œ"><a href="#è„šæœ¬åŒ–æ“ä½œ" class="headerlink" title="è„šæœ¬åŒ–æ“ä½œ"></a>è„šæœ¬åŒ–æ“ä½œ</h3><p>ç›´æ¥ä½¿ç”¨å‘½ä»¤å¼€å…³NiginxæœåŠ¡æ¯”è¾ƒéº»çƒ¦ï¼Œå¯ä»¥æä¸ªshellè„šæœ¬æ¥å°è£…ä¸€ä¸‹ç›´æ¥ä¸€ä¸ªå…¨å±€å‘½ä»¤å¯åŠ¨å…³é—­ï¼Œè¿™é‡Œçªç„¶æƒ³èµ·åˆ°è‡ªå·±çš„æ¯•è®¾ï¼Œå½“æ—¶ç¨‹åºåœ¨éƒ¨ç½²è¿è¡Œçš„æ—¶å€™ç‰¹éº»çƒ¦ï¼Œæ‰€ä»¥æŠŠæ¯ä¸ªèŠ‚ç‚¹å¤æ‚çš„å‚æ•°å‘½ä»¤å°è£…æˆäº†ä¸€ä¸ªä¸ªè„šæœ¬ï¼Œæœ€åå‘ç°ä¸€ä¸ªä¸ªçš„å¯åŠ¨è„šæœ¬å¤ªæŠ˜è…¾äº†ï¼Œæ‰€ä»¥åˆå†™äº†ä¸€ä¸ªå¯åŠ¨è„šæœ¬çš„è„šæœ¬â€¦</p>
<p>è¿™é‡Œæä¾›ä¸€ä¸ªæ§åˆ¶NginxæœåŠ¡çš„è„šæœ¬ï¼Œè¿™ä¸ªè„šæœ¬ä¸æ˜¯å®˜æ–¹æä¾›çš„ï¼Œåšå¼€å‘æ—¶é€›gitæ‰¾åˆ°å¥½ç”¨çš„è„šæœ¬æ—¶ä¸è¦ç›´æ¥æ‹¿æ¥è·‘ï¼Œæœ€å¥½å…ˆæµè§ˆä¸€ä¸‹è„šæœ¬çš„é€»è¾‘</p>
<p>åˆ›å»º<code>/etc/init.d/nginx</code>æ–‡ä»¶ä¸­ï¼Œå°†åé¢æä¾›çš„è„šæœ¬æ‹·è´åˆ°é‡Œé¢ï¼Œå¹¶ä¿®æ”¹å¯æ‰§è¡Œæƒé™<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod 777 nginx</span><br></pre></td></tr></table></figure></p>
<h4 id="æœåŠ¡å‘½ä»¤"><a href="#æœåŠ¡å‘½ä»¤" class="headerlink" title="æœåŠ¡å‘½ä»¤"></a>æœåŠ¡å‘½ä»¤</h4><p><code>service Nginx start</code>  å¯åŠ¨æœåŠ¡</p>
<p><code>service Nginx stop</code> åœæ­¢</p>
<p><code>service Nginx status</code> çŠ¶æ€</p>
<p><code>service Nginx reload</code> åŠ¨æ€é‡è½½é…ç½®æ–‡ä»¶</p>
<h4 id="shellè„šæœ¬æºä»£ç "><a href="#shellè„šæœ¬æºä»£ç " class="headerlink" title="shellè„šæœ¬æºä»£ç "></a>shellè„šæœ¬æºä»£ç </h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span>!/bin/sh</span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">#</span> nginx - this script starts and stops the nginx daemon</span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">#</span> chkconfig:   - 85 15 </span><br><span class="line"><span class="meta">#</span> description:  Nginx is an HTTP(S) server, HTTP(S) reverse \</span><br><span class="line"><span class="meta">#</span>               proxy and IMAP/POP3 proxy server</span><br><span class="line"><span class="meta">#</span> processname: nginx</span><br><span class="line"><span class="meta">#</span> config:      /etc/nginx/nginx.conf</span><br><span class="line"><span class="meta">#</span> config:      /etc/sysconfig/nginx</span><br><span class="line"><span class="meta">#</span> pidfile:     /var/run/nginx.pid</span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span> Source function library.</span><br><span class="line">. /etc/rc.d/init.d/functions</span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span> Source networking configuration.</span><br><span class="line">. /etc/sysconfig/network</span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span> Check that networking is up.</span><br><span class="line">[ "$NETWORKING" = "no" ] &amp;&amp; exit 0</span><br><span class="line"> </span><br><span class="line">nginx="/usr/local/tengine/sbin/nginx"</span><br><span class="line">prog=$(basename $nginx)</span><br><span class="line"> </span><br><span class="line">NGINX_CONF_FILE="/usr/local/tengine/conf/nginx.conf"</span><br><span class="line"> </span><br><span class="line">[ -f /etc/sysconfig/nginx ] &amp;&amp; . /etc/sysconfig/nginx</span><br><span class="line"> </span><br><span class="line">lockfile=/var/lock/subsys/nginx</span><br><span class="line"> </span><br><span class="line">make_dirs() &#123;</span><br><span class="line"><span class="meta">   #</span> make required directories</span><br><span class="line">   user=`nginx -V 2&gt;&amp;1 | grep "configure arguments:" | sed 's/[^*]*--user=\([^ ]*\).*/\1/g' -`</span><br><span class="line">   options=`$nginx -V 2&gt;&amp;1 | grep 'configure arguments:'`</span><br><span class="line">   for opt in $options; do</span><br><span class="line">       if [ `echo $opt | grep '.*-temp-path'` ]; then</span><br><span class="line">           value=`echo $opt | cut -d "=" -f 2`</span><br><span class="line">           if [ ! -d "$value" ]; then</span><br><span class="line">               # echo "creating" $value</span><br><span class="line">               mkdir -p $value &amp;&amp; chown -R $user $value</span><br><span class="line">           fi</span><br><span class="line">       fi</span><br><span class="line">   done</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">start() &#123;</span><br><span class="line">    [ -x $nginx ] || exit 5</span><br><span class="line">    [ -f $NGINX_CONF_FILE ] || exit 6</span><br><span class="line">    make_dirs</span><br><span class="line">    echo -n $"Starting $prog: "</span><br><span class="line">    daemon $nginx -c $NGINX_CONF_FILE</span><br><span class="line">    retval=$?</span><br><span class="line">    echo</span><br><span class="line">    [ $retval -eq 0 ] &amp;&amp; touch $lockfile</span><br><span class="line">    return $retval</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">stop() &#123;</span><br><span class="line">    echo -n $"Stopping $prog: "</span><br><span class="line">    killproc $prog -QUIT</span><br><span class="line">    retval=$?</span><br><span class="line">    echo</span><br><span class="line">    [ $retval -eq 0 ] &amp;&amp; rm -f $lockfile</span><br><span class="line">    return $retval</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">restart() &#123;</span><br><span class="line">    configtest || return $?</span><br><span class="line">    stop</span><br><span class="line">    sleep 1</span><br><span class="line">    start</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">reload() &#123;</span><br><span class="line">    configtest || return $?</span><br><span class="line">    echo -n $"Reloading $prog: "</span><br><span class="line">    killproc $nginx -HUP</span><br><span class="line">    RETVAL=$?</span><br><span class="line">    echo</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">force_reload() &#123;</span><br><span class="line">    restart</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">configtest() &#123;</span><br><span class="line"><span class="meta">  $</span>nginx -t -c $NGINX_CONF_FILE</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">rh_status() &#123;</span><br><span class="line">    status $prog</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">rh_status_q() &#123;</span><br><span class="line">    rh_status &gt;/dev/null 2&gt;&amp;1</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">case "$1" in</span><br><span class="line">    start)</span><br><span class="line">        rh_status_q &amp;&amp; exit 0</span><br><span class="line">        $1</span><br><span class="line">        ;;</span><br><span class="line">    stop)</span><br><span class="line">        rh_status_q || exit 0</span><br><span class="line">        $1</span><br><span class="line">        ;;</span><br><span class="line">    restart|configtest)</span><br><span class="line">        $1</span><br><span class="line">        ;;</span><br><span class="line">    reload)</span><br><span class="line">        rh_status_q || exit 7</span><br><span class="line">        $1</span><br><span class="line">        ;;</span><br><span class="line">    force-reload)</span><br><span class="line">        force_reload</span><br><span class="line">        ;;</span><br><span class="line">    status)</span><br><span class="line">        rh_status</span><br><span class="line">        ;;</span><br><span class="line">    condrestart|try-restart)</span><br><span class="line">        rh_status_q || exit 0</span><br><span class="line">            ;;</span><br><span class="line">    *)</span><br><span class="line">        echo $"Usage: $0 &#123;start|stop|status|restart|condrestart|try-restart|reload|force-reload|configtest&#125;"</span><br><span class="line">        exit 2</span><br><span class="line">esac</span><br></pre></td></tr></table></figure>
<blockquote>
<p>æ³¨æ„è„šæœ¬ä¸­æœ‰ä¸¤ä¸ªå˜é‡éœ€è¦è®¾ç½®å¯¹ä½ çš„NginxæœåŠ¡å™¨å¯¹åº”è·¯å¾„<br><br>nginx=â€/usr/local/tengine/sbin/nginxâ€ <br><br>NGINX_CONF_FILE=â€/usr/local/tengine/conf/nginx.confâ€`</p>
</blockquote>
<h2 id="Nginxä½¿ç”¨ç®€ä»‹"><a href="#Nginxä½¿ç”¨ç®€ä»‹" class="headerlink" title="Nginxä½¿ç”¨ç®€ä»‹"></a>Nginxä½¿ç”¨ç®€ä»‹</h2><p>Nginxä½œä¸ºä¸€ä¸ªwebæœåŠ¡å™¨ï¼Œä»¥å†…å­˜å æœ‰å°‘ã€å¹¶å‘èƒ½åŠ›å¼ºè€Œå‡ºåï¼Œæœ‰éå¸¸å¤šå›½å†…çš„äº’è”ç½‘å…¬å¸åœ¨ä½¿ç”¨ï¼›é¦–å…ˆæ˜¯å› ä¸ºé«˜å¹¶å‘ä¸”ä½å†…å­˜å ç”¨ç‰¹æ€§ï¼Œå®˜æ–¹æµ‹è¯•Nginxèƒ½å¤Ÿæ”¯æ’‘5ä¸‡å¹¶å‘é“¾æ¥ï¼Œè¿è¡Œéå¸¸ç¨³å®šï¼Œå…¶æ¬¡æ˜¯æˆ‘ä»¬ç»å¸¸ç”¨å®ƒæ¥åšè´Ÿè½½å‡è¡¡ï¼ŒåŠ¨é™åˆ†ç¦»ç­‰æ“ä½œ</p>
<h3 id="WebæœåŠ¡å™¨ä¸åº”ç”¨æœåŠ¡å™¨"><a href="#WebæœåŠ¡å™¨ä¸åº”ç”¨æœåŠ¡å™¨" class="headerlink" title="WebæœåŠ¡å™¨ä¸åº”ç”¨æœåŠ¡å™¨"></a>WebæœåŠ¡å™¨ä¸åº”ç”¨æœåŠ¡å™¨</h3><p>ç¬¬ä¸€æ¬¡æ¥è§¦ Nginx çš„æ—¶å€™æœ‰ä¸€ä¸ªå°å°çš„ç–‘é—®ï¼Œå“æˆ‘ä¸æ˜¯å·²ç»æœ‰äº†ä¸€ä¸ª tomcat æœåŠ¡å™¨äº†å—ï¼Œè¿™ä¸ªæœåŠ¡å™¨å¯ä»¥å¯¹å¤–æä¾›æœåŠ¡å‘€ï¼Œä¸ºä»€ä¹ˆè¿˜è¦ä½¿ç”¨ Nginx ï¼›</p>
<p>æˆ‘å¯¹äºè¿™ä¸ªé—®é¢˜çš„ç†è§£æ˜¯è¿™æ ·çš„ï¼Œé¦–å…ˆä½ éœ€è¦åŒºåˆ†WebæœåŠ¡å™¨ä¸åº”ç”¨æœåŠ¡å™¨åœ¨åŠŸèƒ½ä¸Šçš„ä¸åŒï¼Œæ‰€è°“ Web æœåŠ¡å™¨ï¼Œæˆ–è€…å«åš HTTP æœåŠ¡å™¨ï¼Œå®ƒä¸»è¦å…³å¿ƒçš„æ˜¯åœ¨ HTTP åè®®å±‚é¢çš„ä¼ è¾“å’Œè®¿é—®æ§åˆ¶ï¼Œæ¯”å¦‚å¸¸è§çš„WebæœåŠ¡å™¨æœ‰Nginxã€Apacheã€IISï¼Œå®ƒä»¬ä¸»è¦æä¾›çš„åŠŸèƒ½æ˜¯è®©å®¢æˆ·ç«¯é€šè¿‡HTTPåè®®è®¿é—®æœåŠ¡å™¨ä¸Šçš„é™æ€èµ„æºï¼Œå¦å¤–å°±æ˜¯åšä»£ç†ã€è´Ÿè½½å‡è¡¡ç­‰ï¼›è€Œå¯¹äºåº”ç”¨æœåŠ¡å™¨ï¼Œæ¯”å¦‚tomcatï¼Œåˆ™æ˜¯ä¸€ä¸ªåº”ç”¨æ‰§è¡Œçš„å®¹å™¨ï¼ŒåŒæ—¶ä¸ºäº†æ–¹ä¾¿åº”ç”¨æœåŠ¡å™¨å¾€å¾€ä¹Ÿä¼šé›†æˆä¸€äº›HTTPæœåŠ¡å™¨åŠŸèƒ½ï¼Œä½†æ˜¯ä¸å¦‚HTTPæœåŠ¡å™¨é‚£ä¹ˆå¼ºå¤§ï¼Œæ‰€ä»¥åº”ç”¨æœåŠ¡å™¨ä¸€èˆ¬æ˜¯è¿è¡Œåœ¨HTTPæœåŠ¡å™¨çš„èƒŒåï¼Œæ‰§è¡Œåº”ç”¨ç¨‹åºä¸šåŠ¡é€»è¾‘ï¼Œæœ€åå°†åŠ¨æ€å†…å®¹è½¬åŒ–ä¸ºé™æ€çš„å†…å®¹åï¼Œç”±HTTPæœåŠ¡å™¨è¿”å›å®¢æˆ·ç«¯ï¼›æ‰€ä»¥ä½ å¯ä»¥çœ‹è§Nginx+tomcatæˆ–è€…Nginx+nodejsç­‰ç»„åˆ</p>
<h3 id="ä»£ç†"><a href="#ä»£ç†" class="headerlink" title="ä»£ç†"></a>ä»£ç†</h3><p>ç»å¸¸å¬åˆ°æ­£å‘ä»£ç†ä¸åå‘ä»£ç†çš„æ¦‚å¿µï¼Œå…¶ä¸­ä»£ç†çš„æ„æ€ä¸è®¾è®¡æ¨¡å¼ä¸­çš„ä»£ç†å…¶å®æ˜¯ä¸€ä¸ªæ„æ€ï¼šç»™æŸä¸€ä¸ªçœŸå®å¯¹è±¡ï¼ˆrealsubjectï¼‰æä¾›ä¸€ä¸ªä»£ç†ï¼ˆproxyï¼‰ï¼Œå¹¶ç”±ä»£ç†å¯¹è±¡ï¼ˆproxyï¼‰æ¥æ§åˆ¶å¯¹çœŸå®å¯¹è±¡ï¼ˆrealsubjectï¼‰çš„è®¿é—®ï¼Œæˆ‘ä»¬åœ¨åŸºäºHTTPåè®®çš„webåœºæ™¯ä¸­æ¥çœ‹ä¸€ä¸‹ï¼Œè¿™é‡Œå°±ä¿©å¯¹è±¡å®¢æˆ·ç«¯ï¼ˆclientï¼‰å’ŒæœåŠ¡å™¨ç«¯ï¼ˆServerï¼‰ï¼Œå¦‚æœä½ å¯¹clientåšäº†ä»£ç†å°±æ˜¯æ­£å‘ä»£ç†ï¼Œæ¯”å¦‚ç§‘å­¦ä¸Šç½‘ï¼Ÿæˆ‘ä»¬éƒ½çŸ¥é“æœ‰äº›ç½‘ç«™æ˜¯ä¸å­˜åœ¨çš„æ¯”å¦‚Googleã€æ²¹ç®¡ï¼Œæˆ‘ä»¬ä¸Šä¸å»ï¼Œé‚£å°±ç”±ä»£ç†æœåŠ¡å™¨æ¥å¸®æˆ‘ä»¬è®¿é—®ï¼Œè¡Œäº†ä¸èƒ½å†å†™äº†â€¦ï¼Œæ¥ç€å¦‚æœä½ å¯¹äºServeråšäº†ä»£ç†é‚£å°±æ˜¯åå‘ä»£ç†ï¼Œæ¯”å¦‚ä½ æœ‰éå¸¸å¤šçš„æœåŠ¡å™¨ç»„æˆäº†ä¸€ä¸ªé›†ç¾¤ï¼Œé€šå¸¸æˆ‘ä»¬æ˜¯ä½¿ç”¨Nginxä¸ºè¿™äº›æœåŠ¡å™¨åšä»£ç†ï¼Œç”¨æˆ·è®¿é—®çš„æ˜¯NginxæœåŠ¡å™¨ï¼Œå¹¶ä¸çŸ¥é“è‡ªå·±çœŸå®è®¿é—®çš„æ˜¯å“ªå°ç‰©ç†æœåŠ¡å™¨ã€‚</p>
<h3 id="è™šæ‹Ÿä¸»æœº"><a href="#è™šæ‹Ÿä¸»æœº" class="headerlink" title="è™šæ‹Ÿä¸»æœº"></a>è™šæ‹Ÿä¸»æœº</h3><p>Nginxå¯ä»¥åšè™šæ‹Ÿä¸»æœºï¼Œæ„æ€å°±æ˜¯å°†ä¸€ä¸ªæœåŠ¡å™¨å½“åšå¤šä¸ªæœåŠ¡å™¨ç”¨ï¼ŒNginxéƒ¨ç½²åœ¨ä¸€ä¸ªç‰©ç†æœåŠ¡å™¨ä¸Šï¼Œå´é€šè¿‡ipã€ç«¯å£ã€åŸŸåå¯¹å¤–å®ç°å¤šä¸ªè®¿é—®å…¥å£ï¼Œè®©å®¢æˆ·ç«¯ä»¥ä¸ºæ˜¯å¤šä¸ªæœåŠ¡å™¨ï¼Œåé¢ä¼šè®²è§£å¦‚ä½•é…ç½®è™šæ‹Ÿä¸»æœºã€‚</p>
<h3 id="è´Ÿè½½å‡è¡¡"><a href="#è´Ÿè½½å‡è¡¡" class="headerlink" title="è´Ÿè½½å‡è¡¡"></a>è´Ÿè½½å‡è¡¡</h3><p>ä¸€å°æœåŠ¡å™¨èƒ½å¤„ç†çš„å¹¶å‘æ˜¯æœ‰ä¸Šé™çš„ï¼Œé€šå¸¸æˆ‘ä»¬ä¸ºäº†æé«˜æœåŠ¡å™¨çš„å¤„ç†å¹¶å‘çš„èƒ½åŠ›å¯ä»¥é‡‡ç”¨è´Ÿè½½å‡è¡¡çš„æ–¹å¼ï¼Œç®€å•ç†è§£ä¸ºå°±æ˜¯åœ¨å¤šå°æœåŠ¡å™¨ä¸Šéƒ¨ç½²äº†ç›¸åŒçš„ç¨‹åºï¼Œåœ¨Nginxåšå¥½é…ç½®ï¼Œç”¨æˆ·è®¿é—®NignxæœåŠ¡å™¨ï¼Œç”±Nginxæ§åˆ¶ç”¨æˆ·è¯·æ±‚ç”±å“ªä¸€å°æœåŠ¡å™¨å¤„ç†ï¼Œæ‰€ä»¥è´Ÿè½½å‡è¡¡å¯ä»¥ç†è§£ä¸ºæ˜¯åå‘ä»£ç† + ä¸ºæ¯ä¸ªä»£ç†è®¾ç½®weightæƒé‡ </p>
<h2 id="Nginxé…ç½®æ–‡ä»¶è§£æ"><a href="#Nginxé…ç½®æ–‡ä»¶è§£æ" class="headerlink" title="Nginxé…ç½®æ–‡ä»¶è§£æ"></a>Nginxé…ç½®æ–‡ä»¶è§£æ</h2><p>Nginxä½¿ç”¨æ¯”è¾ƒå®¹æ˜“ï¼Œä¸ŠèŠ‚æåˆ°çš„åŠŸèƒ½æˆ‘ä»¬ç›´æ¥åœ¨Nginxçš„é…ç½®æ–‡ä»¶ä¸­åšç›¸åº”çš„é…ç½®å°±å¯ä»¥ä½¿ç”¨ï¼Œè€Œä¸éœ€è¦åšå•ç‹¬çš„ç¼–ç¨‹</p>
<p>nginxé…ç½®æ–‡ä»¶åœ¨å®‰è£…ç›®å½•çš„confç›®å½•ä¸­<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/tengine/conf/nginx.conf</span><br></pre></td></tr></table></figure></p>
<h3 id="Nginxé…ç½®æ–‡ä»¶ç»“æ„"><a href="#Nginxé…ç½®æ–‡ä»¶ç»“æ„" class="headerlink" title="Nginxé…ç½®æ–‡ä»¶ç»“æ„"></a>Nginxé…ç½®æ–‡ä»¶ç»“æ„</h3><p>ä¸€èˆ¬æ¥è¯´ï¼ŒNginxé…ç½®æ–‡ä»¶åŒ…å«ä¸€ä¸‹å‡ ä¸ªéƒ¨åˆ†<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> å…¨å±€å—</span><br><span class="line">...              </span><br><span class="line"><span class="meta">#</span> eventså—</span><br><span class="line">events &#123;         </span><br><span class="line">   ...</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#</span> httpå—</span><br><span class="line">http      </span><br><span class="line">&#123;</span><br><span class="line">    # httpå…¨å±€å—</span><br><span class="line">    ...   </span><br><span class="line">    # è™šæ‹Ÿä¸»æœºserverå—</span><br><span class="line">    server        </span><br><span class="line">    &#123; </span><br><span class="line">        # serverå…¨å±€å—</span><br><span class="line">        ...       </span><br><span class="line">        # locationå—</span><br><span class="line">        location [PATTERN]   </span><br><span class="line">        &#123;</span><br><span class="line">            ...</span><br><span class="line">        &#125;</span><br><span class="line">        location [PATTERN] </span><br><span class="line">        &#123;</span><br><span class="line">            ...</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    server</span><br><span class="line">    &#123;</span><br><span class="line">      ...</span><br><span class="line">    &#125;</span><br><span class="line">    # httpå…¨å±€å—</span><br><span class="line">    ...     </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="å…¨å±€å—"><a href="#å…¨å±€å—" class="headerlink" title="å…¨å±€å—"></a>å…¨å±€å—</h4><p>é…ç½®å½±å“nginxå…¨å±€çš„æŒ‡ä»¤ã€‚</p>
<h4 id="eventså—"><a href="#eventså—" class="headerlink" title="eventså—"></a>eventså—</h4><p>è¯¥é…ç½®å½±å“nginxæœåŠ¡å™¨ä¸clientçš„ç½‘ç»œè¿æ¥</p>
<h4 id="httpå—"><a href="#httpå—" class="headerlink" title="httpå—"></a>httpå—</h4><p>ä¸»è¦ç”¨æ¥é…ç½®ä»£ç†ã€ç¼“å­˜ã€æ—¥å¿—å®šä¹‰ç­‰ç»å¤§å¤šæ•°åŠŸèƒ½å’Œç¬¬ä¸‰æ–¹æ¨¡å—çš„é…ç½®ï¼Œå¯ä»¥åµŒå¥—å¤šä¸ªserverï¼Œæ¯ä¸€ä¸ªserverå°±æ˜¯ä¸€ä¸ªè™šæ‹Ÿä¸»æœº</p>
<h4 id="serverå—"><a href="#serverå—" class="headerlink" title="serverå—"></a>serverå—</h4><p>é…ç½®è™šæ‹Ÿä¸»æœºçš„ç›¸å…³å‚æ•°ï¼Œä¸€ä¸ªhttpä¸­å¯ä»¥æœ‰å¤šä¸ªserver</p>
<p>è™šæ‹Ÿä¸»æœºï¼šä¸€ç§ç‰¹æ®Šçš„è½¯ç¡¬ä»¶æŠ€æœ¯,å®ƒå°†ä¸€å°æœåŠ¡å™¨åˆ†æˆå¤šä¸ªè™šæ‹Ÿçš„æœåŠ¡å™¨,æ¯ä¸ªè™šæ‹Ÿä¸»æœºå¯ä»¥ç‹¬ç«‹å¯¹å¤–æä¾›æœåŠ¡,è¿™æ ·å°±å¯ä»¥å®ç°ä¸€å°ä¸»æœºå¯¹å¤–æä¾›å¤šä¸ªwebæœåŠ¡</p>
<h4 id="locationå—"><a href="#locationå—" class="headerlink" title="locationå—"></a>locationå—</h4><p>é…ç½®å…·ä½“è¯·æ±‚çš„è·¯ç”±ï¼Œä»¥åŠå„ç§é¡µé¢çš„å¤„ç†æƒ…å†µ</p>
<h3 id="Nginxé…ç½®æ–‡ä»¶å…·ä½“è§£æ"><a href="#Nginxé…ç½®æ–‡ä»¶å…·ä½“è§£æ" class="headerlink" title="Nginxé…ç½®æ–‡ä»¶å…·ä½“è§£æ"></a>Nginxé…ç½®æ–‡ä»¶å…·ä½“è§£æ</h3><p>è¿™é‡Œæˆ‘ä¼šæŠŠå·¥ç¨‹è‡ªå¸¦çš„é…ç½®æ–‡ä»¶åˆ†æ®µçš„å±•ç¤ºåœ¨ä¸‹æ–¹ï¼Œå¹¶æ•´ç†æ¯ä¸ªå¸¸ç”¨é…ç½®çš„ä½œç”¨</p>
<h4 id="å…¨å±€å—-fragment1"><a href="#å…¨å±€å—-fragment1" class="headerlink" title="å…¨å±€å— - fragment1"></a>å…¨å±€å— - fragment1</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span>user  nobody;</span><br><span class="line">worker_processes  1;</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span>error_log  logs/error.log;</span><br><span class="line"><span class="meta">#</span>error_log  logs/error.log  notice;</span><br><span class="line"><span class="meta">#</span>error_log  logs/error.log  info;</span><br><span class="line"><span class="meta">#</span>error_log  "pipe:rollback logs/error_log interval=1d baknum=7 maxsize=2G";</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span>pid        logs/nginx.pid;</span><br></pre></td></tr></table></figure>
<p><strong>user</strong></p>
<p>å®šä¹‰Nginxè¿è¡Œçš„ç”¨æˆ·å’Œç”¨æˆ·ç»„ï¼Œé»˜è®¤è¢«æ³¨é‡Šå³é»˜è®¤é…ç½®ä¸ºnobodyï¼Œè¿™ä¸ªé…ç½®ä»£è¡¨å“ªä¸ªç”¨æˆ·ä»¥åŠç”¨æˆ·ç»„è¿è¡Œçš„Nginxå¦‚æœåœ¨é…ç½®æ—¶çœç•¥äº†ç”¨æˆ·ç»„åï¼Œé‚£ä¹ˆç”¨æˆ·ç»„åé»˜è®¤ç­‰äºç”¨æˆ·åï¼›é€šå¸¸é‡åˆ°æƒé™é—®é¢˜æ˜¯è¿™ä¸ªå‚æ•°è®¾ç½®çš„é—®é¢˜ï¼Œä¸€èˆ¬ä¸è¦è®¾ç½®ä¸ºroot</p>
<p><code>user zhou zhou;</code></p>
<p><strong>worker_processes</strong></p>
<p>è¿›ç¨‹æ•°ï¼Œå³Nginxå¯ä»¥å¼€å¯å¤šå°‘è¿›ç¨‹ï¼Œå»ºè®®è®¾ç½®ä¸ºç­‰äºCPUæ€»æ ¸å¿ƒæ•°ã€‚</p>
<p><code>worker_processes 4;</code></p>
<p><strong>error_log</strong></p>
<p>å…¨å±€é”™è¯¯æ—¥å¿—ï¼Œæ ¼å¼ä¸º<code>error_log &lt;FILE&gt; &lt;LEVEL&gt;;</code>ï¼Œå…¶ä¸­é”™è¯¯æ—¥å¿—ç±»å‹åŒ…æ‹¬<code>[ debug | info | notice | warn | error | crit ]</code></p>
<p><code>error_log /var/log/nginx/error.log info;</code></p>
<p><strong>pid</strong></p>
<p>è®¾ç½®è¿›ç¨‹æ–‡ä»¶</p>
<p><code>pid /var/run/nginx.pid;</code></p>
<h4 id="eventså—-fragment2"><a href="#eventså—-fragment2" class="headerlink" title="eventså— - fragment2"></a>eventså— - fragment2</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">events &#123;</span><br><span class="line">    worker_connections  1024;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>eventsæ¨¡å—åŒ…å«nginxä¸­æ‰€æœ‰å¤„ç†è¿æ¥çš„è®¾ç½®.</p>
<p><strong>use</strong></p>
<p>eventsæœ‰ä¸€ä¸ªäº‹ä»¶æ¨¡å‹çš„é…ç½®ï¼Œé»˜è®¤é…ç½®æ–‡ä»¶ä¸­æ²¡æœ‰è®¾ç½®ï¼ˆåç»­è¡¥å……æ¯ç§è®¾ç½®çš„ä½œç”¨ï¼‰</p>
<p><code>use [ kqueue | rtsig | epoll | /dev/poll | select | poll ];</code></p>
<p><strong>worker_connections</strong></p>
<p>å•ä¸ªè¿›ç¨‹æœ€å¤§è¿æ¥æ•° <code>worker_connections 1024;</code> </p>
<p>æ‰€ä»¥Nginxæœ€å¤§å¹¶å‘æ€»æ•°æ˜¯ worker_processes å’Œ worker_connections çš„ä¹˜ç§¯ï¼Œå³ max_clients = worker_processes * worker_connectionsï¼›</p>
<p>è®¾ç½®äº†åå‘ä»£ç†çš„æƒ…å†µä¸‹ï¼Œmax_clients = worker_processes * worker_connections / 4ï¼Œåå‘ä»£ç†é™¤ä»¥4æ˜¯ä¸€ä¸ªç»éªŒç»“è®º</p>
<p>å¦å¤–è¯¥è®¾ç½®åªæ˜¯ç†è®ºå€¼ï¼Œworker_connectionså€¼çš„è®¾ç½®è·Ÿå†…å­˜å¤§å°æœ‰å…³ï¼Œè€Œä¸”å› ä¸ºå—åˆ°I/Oçº¦æŸï¼Œæ‰€ä»¥max_clientsçš„å€¼è¦å°äºç³»ç»Ÿå¯ä»¥æ‰“å¼€çš„æœ€å¤§æ–‡ä»¶å¥æŸ„æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘çš„ç³»ç»Ÿæœ€å¤§åŒæ—¶èƒ½æ‰“å¼€è¿™ä¹ˆå¤šæ–‡ä»¶ï¼ŒNginxè¿™è¾¹èƒ½åŒæ—¶åˆ›å»ºçš„è¿æ¥åº”è¯¥å°äºè¿™ä¸ªå€¼ï¼Œè‹¥æŸ¥çœ‹ç³»ç»Ÿæ‰“å¼€çš„æœ€å¤§æ–‡ä»¶å¥æŸ„æ•°ä½¿ç”¨<code>â€“$ cat /proc/sys/fs/file-max</code>å‘½ä»¤</p>
<p>worker_connections çš„å€¼éœ€æ ¹æ®worker_processesè¿›ç¨‹æ•°ç›®å’Œç³»ç»Ÿå¯ä»¥æ‰“å¼€çš„æœ€å¤§æ–‡ä»¶æ€»æ•°è¿›è¡Œé€‚å½“åœ°è¿›è¡Œè®¾ç½®,ä½¿å¾—å¹¶å‘æ€»æ•°å°äºæ“ä½œç³»ç»Ÿå¯ä»¥æ‰“å¼€çš„æœ€å¤§æ–‡ä»¶æ•°ç›®ï¼Œå½“ç„¶ï¼Œç†è®ºä¸Šçš„å¹¶å‘æ€»æ•°å¯èƒ½ä¼šå’Œå®é™…æœ‰æ‰€åå·®ï¼Œå› ä¸ºä¸»æœºè¿˜æœ‰å…¶ä»–çš„å·¥ä½œè¿›ç¨‹éœ€è¦æ¶ˆè€—ç³»ç»Ÿèµ„æºã€‚</p>
<p>æœ€åä¸€ç‚¹æ˜¯ï¼Œlinuxå¯¹äºä¸€ä¸ªè¿›ç¨‹èƒ½æ‰“å¼€çš„æœ€å¤§æ–‡ä»¶å¥æŸ„ä¹Ÿæœ‰é™åˆ¶ï¼Œé…ç½®è¿”å›å¦‚ä¸‹ï¼šç³»ç»Ÿæ€»é™åˆ¶ï¼š <code>/proc/sys/fs/file-max</code>ï¼Œå½“å‰ä½¿ç”¨å¥æŸ„æ•°ï¼š<code>/proc/sys/fs/file-nr</code>ï¼Œä¿®æ”¹å¥æŸ„æ•°ï¼š<code>ulimit -SHn 65535</code></p>
<h4 id="httpå—-fragment3"><a href="#httpå—-fragment3" class="headerlink" title="httpå— - fragment3"></a>httpå— - fragment3</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">http &#123;</span><br><span class="line">    include       mime.types;</span><br><span class="line">    default_type  application/octet-stream;</span><br><span class="line"></span><br><span class="line">    #log_format  main  '$remote_addr - $remote_user [$time_local] "$request" '</span><br><span class="line">    #                  '$status $body_bytes_sent "$http_referer" '</span><br><span class="line">    #                  '"$http_user_agent" "$http_x_forwarded_for"';</span><br><span class="line"></span><br><span class="line">    #access_log  logs/access.log  main;</span><br><span class="line">    #access_log  "pipe:rollback logs/access_log interval=1d baknum=7 maxsize=2G"  main;</span><br><span class="line"></span><br><span class="line">    sendfile        on;</span><br><span class="line">    #tcp_nopush     on;</span><br><span class="line"></span><br><span class="line">    #keepalive_timeout  0;</span><br><span class="line">    keepalive_timeout  65;</span><br><span class="line"></span><br><span class="line">    #gzip  on;</span><br><span class="line"></span><br><span class="line">    server &#123;</span><br><span class="line">    ...</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    server &#123;</span><br><span class="line">    ...</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p><strong>include</strong></p>
<p><code>include mime.types;</code> è¡¨ç¤ºå¼•ç”¨äº†./mime.typesè¿™ä¸ªæ–‡ä»¶ï¼Œå®ƒå­˜å‚¨äº†æ–‡ä»¶æ‰©å±•åä¸æ–‡ä»¶ç±»å‹æ˜ å°„è¡¨ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">types &#123;</span><br><span class="line">text/html                                        html htm shtml;</span><br><span class="line">text/css                                         css;</span><br><span class="line">text/xml                                         xml;</span><br><span class="line">image/gif                                        gif;</span><br><span class="line">image/jpeg                                       jpeg jpg;</span><br><span class="line">application/javascript                           js;</span><br><span class="line">application/atom+xml                             atom;</span><br><span class="line">application/rss+xml                              rss;</span><br><span class="line">.</span><br><span class="line">.</span><br><span class="line">.</span><br></pre></td></tr></table></figure>
<p>ç¬¬ä¸€åˆ—å¯¹åº”HTTPåè®®ä¸­Content-Typeç±»å‹ï¼Œç¬¬äºŒåˆ—æ˜¯è¯¥ç±»å‹å®é™…çš„æ–‡ä»¶æ‰©å±•åï¼ŒNginxé€šè¿‡æœåŠ¡å™¨ç«¯æ–‡ä»¶çš„åç¼€åæ¥åˆ¤æ–­è¿™ä¸ªæ–‡ä»¶å±äºä»€ä¹ˆç±»å‹ï¼Œå†å°†è¯¥æ•°æ®ç±»å‹å†™å…¥HTTPå¤´éƒ¨çš„Content-Typeå­—æ®µä¸­ï¼Œè¿”å›å®¢æˆ·ç«¯</p>
<p><strong>default_type</strong></p>
<p>è¡¨ç¤ºä¸ºmime.typesæ–‡ä»¶ä¸­ä¸å­˜åœ¨çš„æ–‡ä»¶ç±»å‹ï¼Œä½¿ç”¨è¯¥é»˜è®¤ç±»å‹<br><code>default_type application/octet-stream;</code> </p>
<p><strong>charset</strong></p>
<p><code>charset utf-8;</code> é»˜è®¤ç¼–ç </p>
<p><strong>client_header_buffer_size</strong></p>
<p><code>client_header_buffer_size 32k;</code> ä¸Šä¼ æ–‡ä»¶å¤§å°é™åˆ¶</p>
<p><strong>sendfile</strong></p>
<p><code>sendfile</code> sendfileæŒ‡ä»¤æŒ‡å®šnginxæ˜¯å¦è°ƒç”¨sendfileå‡½æ•°æ¥è¾“å‡ºæ–‡ä»¶</p>
<p>sendfile on; å¼€å¯é«˜æ•ˆæ–‡ä»¶ä¼ è¾“æ¨¡å¼ï¼Œå¯¹äºæ™®é€šåº”ç”¨è®¾ä¸º onï¼Œå¯¹äºä¸‹è½½ç­‰IOé‡è´Ÿè½½åº”ç”¨ï¼Œå¯è®¾ç½®ä¸ºoffï¼Œä»¥å¹³è¡¡ç£ç›˜ä¸ç½‘ç»œI/Oå¤„ç†é€Ÿåº¦ï¼Œé™ä½ç³»ç»Ÿçš„è´Ÿè½½ï¼Œå¦‚æœå›¾ç‰‡æ˜¾ç¤ºä¸æ­£å¸¸æŠŠè¿™ä¸ªæ”¹æˆoffã€‚</p>
<p>è¿™ä¸ªå‚æ•°çš„å·¥ä½œåŸç†æ˜¯è¿™æ ·çš„ï¼Œè‹¥è®¾ç½®ä¸ºoffæ—¶ï¼Œè¿›è¡Œä¸‹è½½æ—¶æ–‡ä»¶é¦–å…ˆä¼šä¼ é€’ç»™Nginxåº”ç”¨ï¼Œæ¥ç€Nginxä¼šé€šçŸ¥ç³»ç»Ÿå†…æ ¸ï¼Œå¹¶å°†æ–‡ä»¶ä¼ é€’ç»™å†…æ ¸ï¼Œæœ€åç”±å†…æ ¸é€šè¿‡ç½‘å¡å°†æ–‡ä»¶ä¼ è¾“å‡ºå»ï¼Œæ•´ä¸ªè¿‡ç¨‹æœ‰ä¸¤æ¬¡è€—æ—¶çš„IOæ“ä½œï¼›è€Œè‹¥è®¾ç½®ä¸ºonæ—¶ï¼Œæ–‡ä»¶ä¸å†è¢«ä¼ é€’ç»™Nginxï¼Œè€Œæ˜¯Nginxå‘å†…æ ¸å‘é€æŒ‡ä»¤ï¼Œæ“ä½œå†…æ ¸å»è·å–æ–‡ä»¶é€šè¿‡ç½‘å¡å°†æ–‡ä»¶ä¼ è¾“å‡ºå»</p>
<p><strong>tcp_nopush</strong>   </p>
<p><code>tcp_nopush</code> åœ¨linux/Unixç³»ç»Ÿä¸­ä¼˜åŒ–tcpæ•°æ®ä¼ è¾“ï¼Œä»…åœ¨sendfileå¼€å¯æ—¶æœ‰æ•ˆ</p>
<p><strong>autoindex</strong></p>
<p><code>autoindex on;</code>#å¼€å¯ç›®å½•åˆ—è¡¨è®¿é—®ï¼Œåˆé€‚ä¸‹è½½æœåŠ¡å™¨ï¼Œé»˜è®¤å…³é—­ã€‚</p>
<p><strong>keepalive_timeout</strong></p>
<p><code>keepalive_timeout 120;</code>é•¿è¿æ¥è¶…æ—¶æ—¶é—´ï¼Œå•ä½æ˜¯ç§’</p>
<p><strong>gzip</strong></p>
<p><code>gzip on;</code> å¼€å¯gzipå‹ç¼©è¾“å‡º</p>
<p><code>gzip_min_length 1k;</code>  è®¾ç½®å…è®¸å‹ç¼©çš„é¡µé¢æœ€å°å­—èŠ‚æ•°ï¼Œé¡µé¢å­—èŠ‚æ•°ä»headerå¤´å¾—content-lengthä¸­è¿›è¡Œè·å–ã€‚é»˜è®¤å€¼æ˜¯0ï¼Œä¸ç®¡é¡µé¢å¤šå¤§éƒ½å‹ç¼©ã€‚å»ºè®®è®¾ç½®æˆå¤§äº2kçš„å­—èŠ‚æ•°ï¼Œå°äº2kå¯èƒ½ä¼šè¶Šå‹è¶Šå¤§ã€‚  </p>
<p><code>gzip_buffers 4 16k;</code> ç”¨äºå‘ç³»ç»Ÿç”³è¯·ç¼“å­˜ï¼Œæ¥å­˜å‚¨gzipçš„å‹ç¼©ç»“æœæ•°æ®æµã€‚ ä¾‹å¦‚ 4 4k ä»£è¡¨ä»¥4kä¸ºå•ä½ï¼ŒæŒ‰ç…§åŸå§‹æ•°æ®å¤§å°ä»¥4kä¸ºå•ä½çš„4å€ç”³è¯·å†…å­˜ã€‚ 4 8k ä»£è¡¨ä»¥8kä¸ºå•ä½ï¼ŒæŒ‰ç…§åŸå§‹æ•°æ®å¤§å°ä»¥8kä¸ºå•ä½çš„4å€ç”³è¯·å†…å­˜ã€‚å¦‚æœæ²¡æœ‰è®¾ç½®ï¼Œé»˜è®¤å€¼æ˜¯ç”³è¯·è·ŸåŸå§‹æ•°æ®ç›¸åŒå¤§å°çš„å†…å­˜ç©ºé—´å»å­˜å‚¨gzipå‹ç¼©ç»“æœã€‚</p>
<p><code>gzip_http_version 1.0;</code>å‹ç¼©ç‰ˆæœ¬ï¼ˆé»˜è®¤1.1ï¼Œå‰ç«¯å¦‚æœæ˜¯squid2.5è¯·ä½¿ç”¨1.0ï¼‰</p>
<p><code>gzip_comp_level 2;</code> å‹ç¼©çº§åˆ«ï¼Œ1-10ï¼Œæ•°å­—è¶Šå¤§å‹ç¼©çš„è¶Šå¥½ï¼Œä¹Ÿè¶Šå ç”¨CPUæ—¶é—´  </p>
<p><code>gzip_types text/plain application/x-javascript text/css application/xml;</code>å‹ç¼©ç±»å‹ï¼Œé»˜è®¤å€¼: gzip_types text/htmlï¼Œé»˜è®¤ä¸å¯¹js/cssæ–‡ä»¶è¿›è¡Œå‹ç¼©</p>
<p><del>å“‡å¤ªå¤šäº†å‰©ä¸‹çš„æ˜å¤©å†™</del></p>
<h4 id="serverå—-fragment4"><a href="#serverå—-fragment4" class="headerlink" title="serverå— - fragment4"></a>serverå— - fragment4</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen       80;</span><br><span class="line">    server_name  localhost;</span><br><span class="line"></span><br><span class="line">    #charset koi8-r;</span><br><span class="line"></span><br><span class="line">    #access_log  logs/host.access.log  main;</span><br><span class="line">    #access_log  &quot;pipe:rollback logs/host.access_log interval=1d baknum=7 maxsize=2G&quot;  main;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        root   html;</span><br><span class="line">        index  index.html index.htm;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    #error_page  404              /404.html;</span><br><span class="line"></span><br><span class="line">    # redirect server error pages to the static page /50x.html</span><br><span class="line">    #</span><br><span class="line">    error_page   500 502 503 504  /50x.html;</span><br><span class="line">    location = /50x.html &#123;</span><br><span class="line">        root   html;</span><br><span class="line">    &#125;</span><br><span class="line">    .</span><br><span class="line">    .</span><br><span class="line">    .</span><br><span class="line">    å…¶ä»–locationç•¥</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ¯ä¸€ä¸ªserverå—å°±å¯¹åº”ä¸€ä¸ªè™šæ‹Ÿä¸»æœºé…ç½®ï¼Œåœ¨serverä¸­æœ‰locationé…ç½®ç”¨æ¥è¡¨ç¤ºè¯¥è™šæ‹Ÿä¸»æœºå¯¹åº”çš„ç£ç›˜ç›®å½•</p>
<p>nginxæ”¯æŒä¸‰ç§ç±»å‹çš„è™šæ‹Ÿä¸»æœºé…ç½®</p>
<ul>
<li>åŸºäºipçš„è™šæ‹Ÿä¸»æœºï¼Œ ï¼ˆä¸€å—ä¸»æœºç»‘å®šå¤šä¸ªipåœ°å€ï¼‰</li>
<li>åŸºäºåŸŸåçš„è™šæ‹Ÿä¸»æœºï¼ˆservernameï¼‰</li>
<li>åŸºäºç«¯å£çš„è™šæ‹Ÿä¸»æœºï¼ˆlistenå¦‚æœä¸å†™ipç«¯å£æ¨¡å¼ï¼‰</li>
</ul>
<p><strong>listen</strong></p>
<p><code>listen       80;</code>å½“å‰è™šæ‹Ÿä¸»æœºç›‘å¬çš„ç«¯å£</p>
<p><strong>server_name</strong></p>
<p><code>server_name www.abc.com abc.com;</code> å½“å‰è™šæ‹Ÿä¸»æœºæ˜ å°„çš„åŸŸåï¼Œå¯ä»¥æœ‰å¤šä¸ªç”¨ç©ºæ ¼éš”å¼€</p>
<p><strong>charset</strong></p>
<p><code>charset koi8-r;</code> ç¼–ç é›†</p>
<p><strong>access_log</strong> </p>
<p>è®¿é—®æ—¥å¿—</p>
 <figure class="highlight plain"><figcaption><span>logs/host.access.log  main;</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">access_log  &quot;pipe:rollback logs/host.access_log interval=1d baknum=7 maxsize=2G&quot;  main;</span><br></pre></td></tr></table></figure>
<p><strong>location</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">location / &#123;</span><br><span class="line">    root   html;</span><br><span class="line">    index  index.html index.htm;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>ä¸€ä¸ªurlåˆ†ä¸ºä¸»æœºåä»¥åŠèµ„æºéƒ¨åˆ†ï¼Œä¾‹å¦‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://www.abc.com/account/login.html</span><br></pre></td></tr></table></figure></p>
<p>æ­¤æ—¶<code>http://www.abc.com</code>è¿™éƒ¨åˆ†å°±æ˜¯ä¸»æœºåï¼Œåœ¨Nginxå¯¹åº”serverå—çš„é…ç½®ï¼Œ<code>/account/login.html</code>æ˜¯èµ„æºåå¯¹åº”serverå—ä¸­çš„locationé…ç½®</p>
<h4 id="locationå—-fragment5"><a href="#locationå—-fragment5" class="headerlink" title="locationå— - fragment5"></a>locationå— - fragment5</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"># proxy the PHP scripts to Apache listening on 127.0.0.1:80</span><br><span class="line">#</span><br><span class="line">#location ~ \.php$ &#123;</span><br><span class="line">#    proxy_pass   http://127.0.0.1;</span><br><span class="line">#&#125;</span><br><span class="line"># proxy the PHP scripts to Apache listening on 127.0.0.1:80</span><br><span class="line">#</span><br><span class="line">#location ~ \.php$ &#123;</span><br><span class="line">#    proxy_pass   http://127.0.0.1;</span><br><span class="line">#&#125;</span><br><span class="line"></span><br><span class="line"># pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000</span><br><span class="line">#</span><br><span class="line">#location ~ \.php$ &#123;</span><br><span class="line">#    root           html;</span><br><span class="line">#    fastcgi_pass   127.0.0.1:9000;</span><br><span class="line">#    fastcgi_index  index.php;</span><br><span class="line">#    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;</span><br><span class="line">#    include        fastcgi_params;</span><br><span class="line">#&#125;</span><br><span class="line"></span><br><span class="line"># deny access to .htaccess files, if Apache&apos;s document root</span><br><span class="line"># concurs with nginx&apos;s one</span><br><span class="line">#</span><br><span class="line">#location ~ /\.ht &#123;</span><br><span class="line">#    deny  all;</span><br><span class="line">#&#125;</span><br></pre></td></tr></table></figure>
<p><strong>locationæ ¼å¼</strong></p>
<p>location [ = | ~ | ~* | ^~ ] uri { â€¦ }</p>
<ul>
<li><p><code>location URI {}</code> å¯¹å½“å‰è·¯å¾„åŠå­è·¯å¾„ä¸‹çš„æ‰€æœ‰å¯¹è±¡éƒ½ç”Ÿæ•ˆï¼›</p>
</li>
<li><p><code>location = URI {}</code> æ³¨æ„URLæœ€å¥½ä¸ºå…·ä½“è·¯å¾„ã€‚  ç²¾ç¡®åŒ¹é…æŒ‡å®šçš„è·¯å¾„ï¼Œä¸åŒ…æ‹¬å­è·¯å¾„ï¼Œå› æ­¤ï¼Œåªå¯¹å½“å‰èµ„æºç”Ÿæ•ˆï¼›</p>
</li>
<li><p><code>location ~ URI {}   location ~* URI {}</code>  æ¨¡å¼åŒ¹é…URIï¼Œæ­¤å¤„çš„URIå¯ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ï¼Œ~åŒºåˆ†å­—ç¬¦å¤§å°å†™ï¼Œ~*ä¸åŒºåˆ†å­—ç¬¦å¤§å°å†™ï¼›</p>
</li>
<li><p><code>location ^~ URI {}</code> ç¦ç”¨æ­£åˆ™è¡¨è¾¾å¼</p>
</li>
</ul>
<p><strong>ä¼˜å…ˆçº§</strong>ï¼š= &gt; ^~ &gt; ~|~* &gt;  /|/dir/</p>
<p>è¿™é‡Œå±•ç¤ºä¸€ä¸ªdemo<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"># =æ˜¯æŒ‡åŒ¹é…ä¸æ¡ä»¶å®Œå…¨ç›¸åŒçš„è·¯å¾„ï¼Œæ­¤æ—¶åªåŒ¹é…/çš„èµ„æºè·¯å¾„ï¼Œå½¢å¦‚/accountç­‰è·¯å¾„ä¸ä¼šè¢«åŒ¹é…</span><br><span class="line">location = / &#123;</span><br><span class="line">    [ configuration A ]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># å› ä¸ºæ‰€æœ‰çš„åœ°å€éƒ½ä»¥ / å¼€å¤´ï¼Œæ‰€ä»¥è¿™æ¡è§„åˆ™å°†åŒ¹é…åˆ°æ‰€æœ‰è¯·æ±‚ï¼Œä½†è¿˜ä¼šç»§ç»­å¾€ä¸‹åŒ¹é…ï¼Œæ­£åˆ™å’Œæœ€é•¿å­—ç¬¦ä¸²ä¼šä¼˜å…ˆåŒ¹é…</span><br><span class="line">location / &#123;</span><br><span class="line">    [ configuration B ]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># åŒ¹é…ä»»ä½•ä»¥ /documents/ å¼€å¤´çš„è·¯å¾„ï¼ŒåŒ¹é…ç¬¦åˆä»¥åï¼Œè¿˜ä¼šç»§ç»­å¾€ä¸‹æœç´¢ï¼Œåªæœ‰åé¢çš„æ­£åˆ™è¡¨è¾¾å¼æ²¡æœ‰åŒ¹é…åˆ°æ—¶ï¼Œè¿™ä¸€æ¡æ‰ä¼šé‡‡ç”¨è¿™ä¸€æ¡</span><br><span class="line">location /documents/ &#123;</span><br><span class="line">    [ configuration C ]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># åŒ¹é…ä»»ä½•ä»¥ /images/ å¼€å¤´çš„åœ°å€ï¼Œå¦‚æœåŒ¹é…ç¬¦åˆä»¥åï¼Œåˆ™ä¸éœ€è¦åç»­è¿›è¡Œæ­£åˆ™åŒ¹é…</span><br><span class="line">location ^~ /images/ &#123;</span><br><span class="line">    [ configuration D ]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># åŒ¹é…æ‰€æœ‰ä»¥ gif,jpgæˆ–jpeg ç»“å°¾çš„è¯·æ±‚</span><br><span class="line">location ~* \.(gif|jpg|jpeg)$ &#123;</span><br><span class="line">    [ configuration E ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<!-- 
ç»“è®º
- locationä¼šä»å¤´å¼€å§‹é¡ºåºéå†åˆ°æœ€å
    - å¦‚æœlocation æ˜¯=ç²¾ç¡®åŒ¹é…æŒ‡å®šçš„è·¯å¾„ï¼Œè‹¥æ‰¾åˆ°å¯¹åº”åŒ¹é…ç›´æ¥ç»“æŸ
    - å¦‚æœlocation æ˜¯^~ï¼Œåç»­ä¸ä¼šå†åŒ¹é…ä»»ä½•çš„æ­£åˆ™è¡¨è¾¾å¼locationï¼Œç»§ç»­éå†ä½†ä¸æ˜¯é¡ºåºè€Œæ˜¯è·³åº
    - å…¶ä»–location å¦‚æœåŒ¹é…ä¸Šè®°å½•å¹¶ç»§ç»­å‘ä¸‹ï¼ŒæœªåŒ¹é…ä¸Šä¹Ÿç»§ç»­å‘ä¸‹
- ç»“æŸåæ‰¾åˆ°æœ€é•¿å­—ç¬¦ä¸²æœ€ä¸ºåŒ¹é…ç»“æœ -->

      
    </div>
    
    
    

    

    

    

    <div>
      
        <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">æœ¬æ–‡ç»“æŸ æ„Ÿè°¢é˜…è¯»</div>
    
</div>
      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Nginx/" rel="tag"># Nginx</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2020/07/08/java-7/" rel="next" title="JavaWebç¬”è®°-SpringBoot D4">
                <i class="fa fa-chevron-left"></i> JavaWebç¬”è®°-SpringBoot D4
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2020/07/12/architect-2/" rel="prev" title="JavaWebç¬”è®°-Nginx D2">
                JavaWebç¬”è®°-Nginx D2 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
    </div>
  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            æ–‡ç« ç›®å½•
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            ç«™ç‚¹æ¦‚è§ˆ
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/uploads/img.jpeg" alt="é»‘é¢å®å®">
            
              <p class="site-author-name" itemprop="name">é»‘é¢å®å®</p>
              <p class="site-description motion-element" itemprop="description">å•çº¯çš„èœé¸¡ä¸€æš</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">33</span>
                  <span class="site-state-item-name">æ—¥å¿—</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categrories/index.html">
                  <span class="site-state-item-count">7</span>
                  <span class="site-state-item-name">åˆ†ç±»</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">10</span>
                  <span class="site-state-item-name">æ ‡ç­¾</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/yourname" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:yourname@gmail.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Nginxï¼ˆTengineï¼‰å®‰è£…-amp-è„šæœ¬åŒ–æ“ä½œ"><span class="nav-number">1.</span> <span class="nav-text">Nginxï¼ˆTengineï¼‰å®‰è£…&amp;è„šæœ¬åŒ–æ“ä½œ</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ç¯å¢ƒ-amp-ä¾èµ–"><span class="nav-number">1.1.</span> <span class="nav-text">ç¯å¢ƒ&amp;ä¾èµ–</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ä¸‹è½½-amp-å®‰è£…"><span class="nav-number">1.2.</span> <span class="nav-text">ä¸‹è½½&amp;å®‰è£…</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#è¡¥å……"><span class="nav-number">1.3.</span> <span class="nav-text">è¡¥å……</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#è„šæœ¬åŒ–æ“ä½œ"><span class="nav-number">1.4.</span> <span class="nav-text">è„šæœ¬åŒ–æ“ä½œ</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#æœåŠ¡å‘½ä»¤"><span class="nav-number">1.4.1.</span> <span class="nav-text">æœåŠ¡å‘½ä»¤</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#shellè„šæœ¬æºä»£ç "><span class="nav-number">1.4.2.</span> <span class="nav-text">shellè„šæœ¬æºä»£ç </span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Nginxä½¿ç”¨ç®€ä»‹"><span class="nav-number">2.</span> <span class="nav-text">Nginxä½¿ç”¨ç®€ä»‹</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#WebæœåŠ¡å™¨ä¸åº”ç”¨æœåŠ¡å™¨"><span class="nav-number">2.1.</span> <span class="nav-text">WebæœåŠ¡å™¨ä¸åº”ç”¨æœåŠ¡å™¨</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ä»£ç†"><span class="nav-number">2.2.</span> <span class="nav-text">ä»£ç†</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#è™šæ‹Ÿä¸»æœº"><span class="nav-number">2.3.</span> <span class="nav-text">è™šæ‹Ÿä¸»æœº</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#è´Ÿè½½å‡è¡¡"><span class="nav-number">2.4.</span> <span class="nav-text">è´Ÿè½½å‡è¡¡</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Nginxé…ç½®æ–‡ä»¶è§£æ"><span class="nav-number">3.</span> <span class="nav-text">Nginxé…ç½®æ–‡ä»¶è§£æ</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Nginxé…ç½®æ–‡ä»¶ç»“æ„"><span class="nav-number">3.1.</span> <span class="nav-text">Nginxé…ç½®æ–‡ä»¶ç»“æ„</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#å…¨å±€å—"><span class="nav-number">3.1.1.</span> <span class="nav-text">å…¨å±€å—</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#eventså—"><span class="nav-number">3.1.2.</span> <span class="nav-text">eventså—</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#httpå—"><span class="nav-number">3.1.3.</span> <span class="nav-text">httpå—</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#serverå—"><span class="nav-number">3.1.4.</span> <span class="nav-text">serverå—</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#locationå—"><span class="nav-number">3.1.5.</span> <span class="nav-text">locationå—</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Nginxé…ç½®æ–‡ä»¶å…·ä½“è§£æ"><span class="nav-number">3.2.</span> <span class="nav-text">Nginxé…ç½®æ–‡ä»¶å…·ä½“è§£æ</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#å…¨å±€å—-fragment1"><span class="nav-number">3.2.1.</span> <span class="nav-text">å…¨å±€å— - fragment1</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#eventså—-fragment2"><span class="nav-number">3.2.2.</span> <span class="nav-text">eventså— - fragment2</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#httpå—-fragment3"><span class="nav-number">3.2.3.</span> <span class="nav-text">httpå— - fragment3</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#serverå—-fragment4"><span class="nav-number">3.2.4.</span> <span class="nav-text">serverå— - fragment4</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#locationå—-fragment5"><span class="nav-number">3.2.5.</span> <span class="nav-text">locationå— - fragment5</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      
    
      <!--/tag cloud-->
      <!--
        <script type="text/javascript" charset="utf-8" src="/js/tagcloud.js"></script>
        <script type="text/javascript" charset="utf-8" src="/js/tagcanvas.js"></script>
        <div class="widget-wrap">
            <h3 class="widget-title"></h3>
            <div id="myCanvasContainer" class="widget tagcloud" style="margin-top">
                <canvas width="250" height="250" id="resCanvas" style="width:100%">
                    <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Cmake/">Cmake</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/FastDFS/">FastDFS</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LVS/">LVS</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Nginx/">Nginx</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Spring/">Spring</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SpringBoot/">SpringBoot</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jsåŸºç¡€/">jsåŸºç¡€</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nodejs/">nodejs</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vue/">vue</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/webpack/">webpack</a><span class="tag-list-count">5</span></li></ul>
                </canvas>
            </div>
        </div>
      -->
      <!--/end tag cloud-->

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <!-- è¯„è®ºæ¡†ç¾åŒ– -->
<script src="./js/src/Valine.min.js"></script>
<style>
    #comments .veditor{
        min-height: 10rem;
        background-image: url('/uploads/comment.png');
        background-size: contain;
        background-repeat: no-repeat;
        background-position: right;
        background-color: rgba(255,255,255,0);
        resize: none;}
</style>
<div class="copyright">&copy; 2018 &mdash; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-snowflke-o"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">é»‘é¢å®å®</span>

  
</div>









        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

  </div>
  <script src="/js/src/dynamicBackground.js" type="text/javascript"></script>
  
  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  










  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src="//unpkg.com/valine/dist/Valine.min.js"></script>
  
  <script type="text/javascript">
    var GUEST = ['nick','mail','link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item=>{
      return GUEST.indexOf(item)>-1;
    });
    new Valine({
        el: '#comments' ,
        verify: false,
        notify: false,
        appId: 'Bm4PDVfyII7AkipwzxUcreCx-gzGzoHsz',
        appKey: '615Uf5xJsI8lA8parGYw56gv',
        placeholder: 'å‘è¡¨ä½ çš„çœ‹æ³•å§ï¼',
        avatar:'mm',
        guest_info:guest,
        pageSize:'10' || 10,
    });
  </script>



  





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
  <script>AV.initialize("Bm4PDVfyII7AkipwzxUcreCx-gzGzoHsz", "615Uf5xJsI8lA8parGYw56gv");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  

  
  

  

  

  


 <!-- <script type="text/javascript" src="/js/src/instantclick.js" data-no-instant></script>
  <script data-no-instant>InstantClick.init();</script>-->

</body>
</html>
